// stupid questions !!!
int comp(const void* a, const void* b)
{
    return *((int*)a) - *((int*)b);
}

int minMalwareSpread(int** graph, int graphRowSize, int *graphColSizes, int* initial, int initialSize)
{
    if (initialSize == 1)
        return initial[0];

    char* bits = calloc(sizeof(char), graphRowSize);

    qsort(initial, initialSize, sizeof(int), comp);

    for (int i = 0; i < initialSize; i ++)
        bits[initial[i]] = 1;

    int* checked = calloc(sizeof(int), graphRowSize);

    int si = 0;
    int stack[512];

    int max = INT_MIN;
    int r = -1;
    for (int i = 0; i < initialSize; i ++)
    {
        int x = initial[i];
        if (!checked[x])
        {
            bool found = true;
            si = 0;
            checked[x] = i + 1;
            stack[si ++] = x;

            int c_max = 1;

            while (si)
            {
                int z = stack[-- si];
                int* g = graph[z];

                for (int j = 0; j < graphRowSize; j ++)
                    if (g[j])
                    {
                        if (!checked[j])
                        {
                            c_max ++;
                            checked[j] = i + 1;
                            if (bits[j])
                            {
                                found = false;
                                break;
                            }
                            stack[si ++] = j;
                        }
                        else if (checked[j] != i + 1)
                        {
                            found = false;
                            break;
                        }
                    }
            }

            if (found)
            {
                if (c_max > max)
                {
                    max = c_max;
                    r = x;
                }
            }
        }
    }

    return r >= 0 ? r : initial[0];
}
